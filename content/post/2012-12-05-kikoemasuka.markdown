---
layout: post
title: "聞こえますか…自動生成…してみた…よ…"
slug: kikoemasuka
date: 2012-12-05T23:07:00+09:00
comments: true
categories: 
---

聞こえますか…あなたの心に直接…で始まるこのテンプレート．
誰かが「文章入力したら…を自動で入れてくれるのないかな」って呟いてたのでつくってみた．

<!-- More -->

## サクッと作成

[TinySegmenter](http://chasen.org/~taku/software/TinySegmenter/)で単語分割，
ランダムに…を単語の間に挿入して出力してみた．

- [聞こえますか…](http://shogo82148.github.com/kikoemasuka/)

この程度なら数十分あれば作れますね．

## 挿入位置を学習してみる

さて，実際やってみるとちょっと挿入位置が不自然な気がします．
世の中に出回っているツイートでは単語間ではなく文節の間に挿入しているのが多いように見えます．

しかし，TinySegmenterは品詞情報をつけてはくれないので文節の判定は少し面倒ですね．

・・・待てよ・・・このテンプレートを使ったツイートなんて大量に手に入る・・・これから学習すればいいんじゃね？

はい，やってみましょう．

### ツイートを集める

Twitter APIを使ってテンプレートを使っているようなツイートを拾ってきます．
** 「聞こえますか OR きこえますか -RT」** で検索してみました．

普段Twitter APIを叩くときは[Tweepy](https://github.com/tweepy/tweepy)を使っているのですが，これで検索するとあまり古いツイートは取れません．
API 1.1 を使うと古いツイートも取ってこれるらしいので，強引にTweepyを書き換えて1.1対応．
** 72,529ツイートの取得に成功しました． **
プログラムについてはTweepyの書き換えでゴチャゴチャしているのでまた今度．


### TinySegmenterMakerに放り込む

カッコで囲まれている部分を抽出，点々を空白に置換，パクリツイッタラー消去などの処理をした後，
[TinySegmentermaker](https://github.com/shogo82148/TinySegmenterMaker)に放り込みます．
実際に学習に使ったツイートは49,573ツイートです．
10000回の繰り返しで，学習結果は以下のようになりました．

``` plain
Result:
Accuracy: 94.794% (3466578/3656961)
Precision: 90.9504% (526277/578642)
Recall: 79.2234% (526277/664295)
System/Answer p/p p/n n/p n/n: 526277 52365 138018 2940301
```

約95%の精度という非常に高い性能を示してくれましたが，
区切るところ(p)よりも区切らないところ(n)のほうが多いためですね．
Recallが8割しかありませんが，人によるばらつきが大きそうなので，まあこんなもんでしょう．

学習が終わったら最後にオリジナルのTinySegmenterを学習後のもので置き換えるだけ．
チェックボックスで単語分割とツイートの学習結果，どちらを使うか選択できます．
なんだかそれっぽくなりましたかね・・・？


## 元ネタについて
ところでこのテンプレートの元ネタについて調査している方がいらっしゃるようです．

- [「聞こえますか…心に直接…」のオリジナル検証](http://notes.vanu.jp/post/36656640146/kikoemasuka)

ゲームが元ネタだ，っていう人を時々見かけたけど，
検証してみると微妙に内容が違うらしい．
もちろん影響は受けているんだろうけどね．
マンガとかゲームで始めて心に直接語りかけたのって何なんだろう？

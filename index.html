<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic:wght@400;700&family=Noto+Sans+Mono&display=swap" rel="stylesheet"> 

  
  <title>Shogo&#39;s Blog</title>

  
  
  <link rel="stylesheet" href="/css/hugo-octopress.css">

  
  
    <link rel="stylesheet" href="https://shogo82148.github.io/css/syntax.css">
  

  
  <link href="https://shogo82148.github.io/favicon.png" rel="icon">

  
  <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Shogo&#39;s Blog" />

  <meta name="description" content="" />
  <meta name="keywords" content="">
  <meta name="author" content="ICHINOSE Shogo">

  
  <meta name="generator" content="Hugo 0.120.4">


<script async src="https://www.googletagmanager.com/gtag/js?id=G-40R0PCLKVF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-40R0PCLKVF');
</script>


<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

  
  
</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="https://shogo82148.github.io/">Shogo&#39;s Blog</a></h1>
  <h2></h2>
</hgroup>
</header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
</ul>

<ul class="subscription">
  
</ul>


  <form action="https://www.google.com/search" method="get" target="_blank">
    <fieldset role="search">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <input type="hidden" name="q" value="site:https://shogo82148.github.io/" />
    </fieldset>
  </form>

</nav>




  

<div id="main">
  <div id="content">
    <div class="blog-index">
      
      
      <article>
        
        

<header>
  <p class="meta">Dec 16, 2025
     - 1 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/perl/">perl </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/12/16/aws-lambda-supports-managed-instances/">AWS::Lambdaがマネージドインスタンスに対応しました</a>
  </h1>
</header>

        
          <p>この記事は、Perl Advent Calendar 2025 16日目の記事です。 15日目は@mackee_wで「YAPC::Fukuoka 2025非公式リジェクトコンを開催しました」でした。
背景 2025 年 11 月 30 日、AWS Lambda マネージドインスタンスが発表されました。
AWS Lambda マネージドインスタンスのご紹介：サーバーレスの簡単さと EC2 の柔軟性 AWS Lambda 関数をEC2上で実行できるようにするサービスです。 楽しそうですね。AWS::Lambdaでもサポートしてみました。
実装 現時点でのドキュメントには残念ながらカスタムランタイムのサポートはありません。
Lambda Managed Instances runtimes ただし、カスタムランタイムのサポート予定はあるみたい？Goのランタイムでは対応が進んでます。
Add support for AWS_LAMBDA_MAX_CONCURRENCY aws/aws-lambda-go#600 これを参考に実装を進めました。
Add support for AWS_LAMBDA_MAX_CONCURRENCY shogo82148/p5-aws-lambda#204 Perlランタイムの並行制御 DefaultのAWS Lambda実行環境では、ひとつ実行環境に対して一度にひとつのタスクが割り当てられます。 それに対して、マネージドインスタンスではひとつの実行環境に一度に複数のタスクが割り当てられ、各タスクは並行処理されます。ランタイムによってタスクの並行処理のやり方が異なるため、注意が必要です。
AWS::Lambdaの場合はプロセスによってタスクの並行処理を行います。
まとめ AWS::Lambda でAWS Lambda マネージドインスタンスのサポートを行いました。 ぜひ試してみてください！
明日17日は@ijookidさんで『perlが「オワコン」扱いされるに至った本当の理由とは？』です。
🐰 新記事跳ねて、ランタイム道しるべ、
Perl と Lambda、手を取り進む、
ドキュメントの畦（あぜ）に一輪咲き、
読む者よ知恵を拾い行け、
軽やかに、未来へぴょん。
by CodeRabbit
参考 AWS::Lambda AWS Lambda マネージドインスタンスのご紹介：サーバーレスの簡単さと EC2 の柔軟性 Add support for AWS_LAMBDA_MAX_CONCURRENCY aws/aws-lambda-go#600 Add support for AWS_LAMBDA_MAX_CONCURRENCY shogo82148/p5-aws-lambda#204 </p>
          
        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Dec 13, 2025
     - 1 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/perl/">perl </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/12/13/perl-on-java/">PerlOnJavaで遊んでみた</a>
  </h1>
</header>

        
          <p>この記事は、Perl Advent Calendar 2025 13日目の記事です。 12日目は@takihitoで「10年ぶりCPANリリース＆爆破解体の裏話」でした。
背景 アドベントカレンダーのネタを探しインターネットの海を彷徨っていたところ、 fglock/PerlOnJavaというプロジェクトを見つけました。 なんと、Javaで実装されたPerlのインタープリターです！！ これは熱い！！！
試してみた 今のところビルド済みのバイナリーは提供されていないようなので、 自前でビルドしてあげる必要があります。
macOS上で試してみました。 Javaの開発環境が必要なので、brewを使ってインストールしておきます。
brew install gradle PATH=$(brew --prefix openjdk)/bin:$PATH あとはcloneしてmakeしてあげるだけです。
git clone git@github.com:fglock/PerlOnJava.git cd PerlOnJava make jperl というスクリプト経由でPerlを実行できるようになります。
./jperl -E &#39;say &#34;Hello World&#34;&#39; う、動いたああああーーーー！！！！
ベンチマーク JVM上で実行されていることもあって、やはり性能が気になりますよね。 竹内関数 を使ってベンチマークを取ってみました。
use v5.42; use strict; use warnings; use Benchmark qw(timethis); sub tarai($x, $y, $z) { return $y if $x &lt;= $y; tarai( tarai($x-1, $y, $z), tarai($y-1, $z, $x), tarai($z-1, $x, $y)); } timethis(10, sub { tarai(12, 6, 0) }); まずは普通のPerlから。</p>
          
            <footer>
              <a href="https://shogo82148.github.io/blog/2025/12/13/perl-on-java/" rel="full-article">Read On &rarr;</a>
            </footer>
          
        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Dec 11, 2025
     - 1 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/perl/">perl </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/12/11/any-and-all-keywords-in-perl/">Perl 5.42.0 の any と all キーワードを試してみた</a>
  </h1>
</header>

        
          <p>この記事は、Perl Advent Calendar 2025 11日目の記事です。 10日目は@shogo82148で「Perl 5.43.5 の Signatures Named Parameters を先取り」でした。
背景・目的 Perl 5.42.0 から any と all キーワードが使えるようになったそうです。 まだ実験的機能ですが遊んでみます。
試してみた まずは all キーワードから試してみます。 まだ実験的機能扱いなので、明示的に機能を有効化することと、警告を無効化することが必要です。
use v5.42; use feature &#39;keyword_all&#39;; no warnings &#39;experimental::keyword_all&#39;; my @numbers = (2, 4, 8, 16); if ( all { $_ % 2 == 0 } @numbers ) { say &#34;All the numbers are even&#34;; } 出力：
All the numbers are even (2, 4, 8, 16) はすべて偶数なので、意図した結果が得られました。</p>
          
            <footer>
              <a href="https://shogo82148.github.io/blog/2025/12/11/any-and-all-keywords-in-perl/" rel="full-article">Read On &rarr;</a>
            </footer>
          
        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Dec 10, 2025
     - 2 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/go/">go </a><a class="label" href="https://shogo82148.github.io/categories/golang/">golang </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/12/10/synctest-not-supported-with-asynctimerchan/">Goのsynctestを使おうとしたらsynctest.Run not supported with asynctimerchanと怒られたときの対処法</a>
  </h1>
</header>

        
          <p>TL;DR Go 1.25 から正式サポートされたtesting/synctestパッケージを使ってみた 「synctest.Run not supported with asynctimerchan」というメッセージとともにpanicした go mod edit -go=1.23 を実行すれば解決 背景 shogo82148/go-retry は指数的バックオフをよしなになってくれるライブラリーです。
shogo82148/go-retry Goで指数的バックオフをやってくれるgo-retryを書いた go-retry v1.2.0 リリースのお知らせ、ジェネリクスがやってきた go-retry v2 リリースのお知らせ は待ち時間を調整するテストを書くために、「実際にSleepをして経過時間を取得する」という方法を採用しています。
// テストのイメージ func Test(t *testing.T) { var policy = retry.Policy{ MinDelay: 100 * time.Millisecond, MaxDelay: time.Second, MaxCount: 3, } // 実際にSleepをして経過時間を取得する start := time.Now() _ = policy.Do(t.Context(), func() error { return errors.New(&#34;some error&#34;) }) d := time.Since(start) if d &lt; 300*time.Millisecond { t.Errorf(&#34;want at least 300ms, got %s&#34;, d) } } このテストは実際に300ミリ秒Sleepしてしまうので、テストに必ず300ミリ秒かかってしまいます。 また実際のSleep時間はランタイムの状態によって変化してしまうため、 「300ミリ秒ちょうどSleepする」ことをテストしたいのに、実際にそのようなテストを書くことは難しいです。</p>
          
            <footer>
              <a href="https://shogo82148.github.io/blog/2025/12/10/synctest-not-supported-with-asynctimerchan/" rel="full-article">Read On &rarr;</a>
            </footer>
          
        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Dec 10, 2025
     - 3 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/perl/">perl </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/12/10/signatures-named-parameters-in-perl/">Perl 5.43.5 の Signatures Named Parameters を先取り</a>
  </h1>
</header>

        
          <p>この記事は、Perl Advent Calendar 2025 10日目の記事です。 9日目は@sognmuで「Text::Markdown::Discountのメンテナンスを引き継ぎました」でした。
背景 2025年12月10日時点の最新版のPerl 5.43.5（開発版）で、 サブルーチンの名前付きパラメーター呼び出し（Signatures Named Parameters）がサポートされました。 これは PPC0024 を実装したものです。
どういう機能かさっそく遊んでみましょう。
Perl 5.43.5 のビルド Signatures Named Parameters はまだ安定版のPerlには取り込まれていません。 使用するには開発版のPerlをビルドする必要があります。
plenv install 5.43.5 -Dusedevel plenv local 5.43.5 試してみる ビルドが完了したら実際に試してみましょう。
まだ実験的な（Experimental）機能という位置づけなので、今回検証した挙動は将来変更される可能性があります。 注意してください。
普通に呼び出し サブルーチンの仮引数部に :$alpha と書くと名前付きパラメーターとして扱われます。 サブルーチンの中からは $alpha という変数名でアクセス可能です。 呼び出し側からは alpha =&gt; &quot;A&quot; のように指定します。
use v5.43.5; use experimental qw(signature_named_parameters); sub foo (:$alpha, :$beta) { print &#34;The value of alpha was $alpha\n&#34;; print &#34;The value of beta was $beta\n&#34;; } foo(alpha =&gt; &#34;A&#34;, beta =&gt; &#34;B&#34;); 出力：</p>
          
            <footer>
              <a href="https://shogo82148.github.io/blog/2025/12/10/signatures-named-parameters-in-perl/" rel="full-article">Read On &rarr;</a>
            </footer>
          
        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Dec 3, 2025
     - 4 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/perl/">perl </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/12/03/anybatross-2025fukuoka/">コードゴルフコンテスト Anybatross YAPC::Fukuoka 2025 に参加した</a>
  </h1>
</header>

        
          <p>この記事は、Perl Advent Calendar 2025 4日目の記事です。 3日目はid:hkoba501で「Claude Code は OO Modulino （オゥオゥ・モジュリーノ）も理解してくれる、ぽい！」でした。
YAPC::Fukuoka 2025 の余興でコードゴルフコンテストが開催されました。
コードゴルフコンテスト Anybatross YAPC::Fukuoka 2025 開催のお知らせ PerlAnybatross YAPC::Fukuoka 2025 コードゴルフとは、与えられた仕様に対してできる限り短いソースコードで解答するというゲームです。 今回はPerl、Ruby、Python、JavaScript、PHPなどで参加可能ですが、Perl Advent Calendarのネタのために、　個人的に一番馴染み深いPerlを使って参加しました。 結果、すべての問題をPerlでチャレンジした人の中では2位になることができました。
Hole 1 アルファベットのAやBにあるような、文字の中にある閉じた空間のことをカウンターといいます。
0〜9までの10種と、アルファベット大文字のA〜Zの26種、合計36種の文字やその他の記号を利用した文字列が渡されるので、カウンターの数を数えてください。アルファベット小文字は来ません。その他の記号のカウンターは数えなくてよいです。
1行ずつ数えて、その行までの累積個数と、その行での出現個数を出力してください。
https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/sample サンプルのコードが提供されているので、まずはここから始めていきましょう。
Score: +1065
use v5.40; use utf8; our $COUNTER_MAP = { &#39;0&#39; =&gt; 1, &#39;1&#39; =&gt; 0, &#39;2&#39; =&gt; 0, &#39;3&#39; =&gt; 0, &#39;4&#39; =&gt; 1, &#39;5&#39; =&gt; 0, &#39;6&#39; =&gt; 1, &#39;7&#39; =&gt; 0, &#39;8&#39; =&gt; 2, &#39;9&#39; =&gt; 1, &#39;A&#39; =&gt; 1, &#39;B&#39; =&gt; 2, &#39;C&#39; =&gt; 0, &#39;D&#39; =&gt; 1, &#39;E&#39; =&gt; 0, &#39;F&#39; =&gt; 0, &#39;G&#39; =&gt; 0, &#39;H&#39; =&gt; 0, &#39;I&#39; =&gt; 0, &#39;J&#39; =&gt; 0, &#39;K&#39; =&gt; 0, &#39;L&#39; =&gt; 0, &#39;M&#39; =&gt; 0, &#39;N&#39; =&gt; 0, &#39;O&#39; =&gt; 1, &#39;P&#39; =&gt; 1, &#39;Q&#39; =&gt; 1, &#39;R&#39; =&gt; 1, &#39;S&#39; =&gt; 0, &#39;T&#39; =&gt; 0, &#39;U&#39; =&gt; 0, &#39;V&#39; =&gt; 0, &#39;W&#39; =&gt; 0, &#39;X&#39; =&gt; 0, &#39;Y&#39; =&gt; 0, &#39;Z&#39; =&gt; 0, }; my $input = do { local $/; &lt;STDIN&gt; }; my @lines = split /\n/, $input; my @results; my $accumulated_count = 0; # 行ごとに処理する for my $line_num (0.</p>
          
            <footer>
              <a href="https://shogo82148.github.io/blog/2025/12/03/anybatross-2025fukuoka/" rel="full-article">Read On &rarr;</a>
            </footer>
          
        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Nov 6, 2025
     - 4 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/go/">go </a><a class="label" href="https://shogo82148.github.io/categories/golang/">golang </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/11/06/my-number-and-prime/">マイナンバーを全列挙して含まれる素数の数を数えた</a>
  </h1>
</header>

        
          <p>背景・目的 「マイナンバー.csvというファイルにチェックディジットの正しい12桁整数を大量に入れておくいたずらを考えた」という𝕏の発言を見て、
マイナンバーが保存された状態でコンピュータが故障したら修理にも出せない https://t.co/ZNK9KKtFkZ ので、絶対にメールでは送らないように言われたことがあったっけ。マイナンバー.csvというファイルにチェックディジットの正しい12桁整数を大量に入れておくいたずらを考えたけど実行してない
&mdash; Haruhiko Okumura (@h_okumura) November 3, 2025 そういえば、過去にマイナンバーの可能性のある数列をすべて列挙した人がいたよなーと思い出しました。 完全に二番煎じですが、自分でもやってみました。
前例 計算が終了 https://t.co/UivoSSaAJU pic.twitter.com/zm1ZznWWtA
&mdash; 弥生　水葉𝕏 (@yayoi_mizuha) November 25, 2024 マイナンバー一覧生成 C++よくわからずコンパイル通らなかったので、Goで再実装してみました。
shogo82148/go-generate-my-number package main import ( &#34;bufio&#34; &#34;io&#34; &#34;os&#34; ) func main() { w := bufio.NewWriterSize(os.Stdout, 1&lt;&lt;20) for i := range 100_000_000_000 { if err := checkDigit(w, i); err != nil { panic(err) } } if err := w.Flush(); err != nil { panic(err) } } func checkDigit(w io.</p>
          
            <footer>
              <a href="https://shogo82148.github.io/blog/2025/11/06/my-number-and-prime/" rel="full-article">Read On &rarr;</a>
            </footer>
          
        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Oct 26, 2025
     - 1 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/github/">github </a><a class="label" href="https://shogo82148.github.io/categories/github-actions/">github-actions </a><a class="label" href="https://shogo82148.github.io/categories/mysql/">mysql </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/10/26/split-actions-setup-mysql/">shogo82148/actions-setup-mysqlのMySQLビルドスクリプト群を別レポジトリーに移行した</a>
  </h1>
</header>

        
          <p>TL;DR shogo82148/actions-setup-mysql には「GitHub Actionsのコード」と「MySQLをビルドするためのスクリプト群」が一緒に入っていたのですが、 このたび「MySQLをビルドするためのスクリプト群」を以下のレポジトリーに移行することにしました。
shogo82148/build-mysql ユーザー側での対応は不要です。
背景・目的 shogo82148/actions-setup-mysql のビルド済みMySQLバイナリー置き場には紆余曲折ありました。 以下のブログ記事はPerlのものですが、MySQLも同じような道筋を辿っています。
Setup Perl GitHub Action を公開しました Setup Perl Environment Action のストレージを Azure Blob Storage に移行しました 紆余曲折あり最終的には GitHub Releases に保存することにしました。 GitHubネイティブの機能で安心感があるのと、なんたって無料なのが魅力的ですね。
v1.45.0 をリリースしたら、 v1.45.0の関連アセットに必要なバイナリーを全部突っ込む、という作戦で運用を続けてきました。 しかし、この方法では以下のような問題がありました。
リリースのたびにすべてのプラットフォームのビルドをし直さなければならない ひとつのリリースに含める事のできるアセットの上限 1000 が見えてきた というわけで、「MySQLをビルドするためのスクリプト群」を別レポジトリーに移行し、 shogo82148/actions-setup-mysql 自体のリリースサイクルとは別に管理するようにしました。
移行作業 shogo82148/build-mysql のセットアップ 「MySQLをビルドするための秘伝のスクリプト群」はすでに手元にあるので、スクリプト群をコピーするたけです。 完成したバイナリーは gh コマンドでアップロードします。
同じMySQLバージョンの再ビルドを行いたい（たとえば、将来リリースされるであろうubuntu-26.04版ビルドの追加とか）ケースも考えて、リリース名に mysql-8.4.6-20251026153058 のようにリリースした日付を入れておきます。 これは、変更不可リリースを有効化しており、過去のリリースを直接書き換えることができないためです。
shogo82148/actions-setup-mysql のダウンロードURL書き換え 毎回 shogo82148/build-mysql のリリースを検索するのも大変なので、 shogo82148/build-mysql の全リリースを gh api --paginate --slurp '/repos/shogo82148/build-mysql/releases?per_page=100' コマンドで取得し、整形したものをソースコードに埋め込んでいます。
[ { &#34;arch&#34;: &#34;arm64&#34;, &#34;distribution&#34;: &#34;mysql&#34;, &#34;os&#34;: &#34;darwin&#34;, &#34;sha256&#34;: &#34;874d49f26f0bcb1cdd186bf768d863cb1da227091609e5873e25255f19e46753&#34;, &#34;url&#34;: &#34;https://github.</p>
          
            <footer>
              <a href="https://shogo82148.github.io/blog/2025/10/26/split-actions-setup-mysql/" rel="full-article">Read On &rarr;</a>
            </footer>
          
        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Oct 24, 2025
     - 3 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/go/">go </a><a class="label" href="https://shogo82148.github.io/categories/golang/">golang </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/10/24/deep-dig-uber-go-dig/">uber-go/dig を深堀りしてみる</a>
  </h1>
</header>

        
          <p>背景・目的 弊社では依存性注入（DI）に google/wire を使用しています。 しかし、一部 Gopher 界隈で話題となったように 2025年8月25日 google/wire はアーカイブされてしまいました！
google/wire がアーカイブされたけどどうすればいいの？ しばらく静観してきたのですが、そうも言ってられなくなったので移行先を考えることにしました。 軽く調べた感じでは uber-go/dig が依存関係も少なく、導入も楽そうです。 しかし google/wire でできたことが uber-go/dig に移行した途端できなくなっては困ります。
検証 そこで、弊社が google/wire で使っている機能が uber-go/dig でも実現できるのか、調査してみました。
依存関係の事前チェック 個人的に一番欲しいのが依存関係の事前チェックです。
たとえばプロバイダーの不足はよくあるミスだと思います。 google/wire は事前にコード生成を行うため、このようなミスに気が付きやすいです。 しかし uber-go/dig では実行時までエラーに気がつけません。
package main import ( &#34;github.com/k0kubun/pp&#34; &#34;go.uber.org/dig&#34; ) type foo struct { } func main() { c := dig.New() // foo のプロバイダーが登録されていない！！！ if err := c.Invoke(func(foo *foo) { pp.Println(foo) }); err != nil { panic(err) // panic: missing dependencies for function &#34;main&#34;.</p>
          
            <footer>
              <a href="https://shogo82148.github.io/blog/2025/10/24/deep-dig-uber-go-dig/" rel="full-article">Read On &rarr;</a>
            </footer>
          
        
      </article>
      
      <article>
        
        

<header>
  <p class="meta">Oct 13, 2025
     - 1 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/go/">go </a><a class="label" href="https://shogo82148.github.io/categories/golang/">golang </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/10/13/ulid-for-golang/">Go向けのULIDライブラリを作った</a>
  </h1>
</header>

        
          <p>背景・目的 ULIDを使っているプロジェクトを見かけました。 Go言語のULID実装は oklog/ulid が有名です。 見かけたプロジェクトでも oklog/ulid を利用していました。
しかし最新版 oklog/ulid v2.1.1 のソースコードを読んでみると色々と気になる実装があります。
まずはデフォルトのエントロピー源が math/rand であること。 math/rand は暗号論的に安全な乱数ではありません。 過去の採番履歴から、次に採番されるIDが予測されてしまう可能性があります。
さらに疑似乱数のSeedに現在時刻（time.Now().UnixNano()）を使用している点。 1秒って10億ナノ秒しかないので、たとえば1秒間に約3.7万プロセスが一斉に起動するような大規模システムの場合、誕生日のパラドックス から50%の確率でSeedが衝突します。 意外と衝突確率高いと思いませんか？ Seedが衝突したということは生成される乱数列も同じなので、ULIDが衝突する確率も高くなります。
最後に、Base32に含まれていない文字が入力された場合、Parse 関数はエラーを報告しないという点。 この場合どのようなULIDが返却されるかは未定義です。
Parse parses an encoded ULID, returning an error in case of failure. ErrDataSize is returned if the len(ulid) is different from an encoded ULID&rsquo;s length. Invalid encodings produce undefined ULIDs. For a version that returns an error instead, see ParseStrict.
from https://pkg.go.dev/github.com/oklog/ulid/v2@v2.1.1#Parse
外部からの入力を受け付けるには心もとない挙動です。
実装 これらの点が気になったので、車輪の再発明ですが、自分でULIDの実装をしてみることにしました。</p>
          
            <footer>
              <a href="https://shogo82148.github.io/blog/2025/10/13/ulid-for-golang/" rel="full-article">Read On &rarr;</a>
            </footer>
          
        
      </article>
      
      
      






<div class="pagination">

    
        
        
        
        <a href="/" aria-label="First" class="label-pagination"><i class="fa fa-angle-double-left fa-lg"></i></a>
    

    

    
        <a href="/" class="label-pagination">1</a>
    
        <a href="/page/2/" class="label-pagination">2</a>
    
        <a href="/page/3/" class="label-pagination">3</a>
    
        <a href="/page/4/" class="label-pagination">4</a>
    
        <a href="/page/5/" class="label-pagination">5</a>
    
        <a href="/page/6/" class="label-pagination">6</a>
    
        <a href="/page/7/" class="label-pagination">7</a>
    
        <a href="/page/8/" class="label-pagination">8</a>
    
        <a href="/page/9/" class="label-pagination">9</a>
    
        <a href="/page/10/" class="label-pagination">10</a>
    
        <a href="/page/11/" class="label-pagination">11</a>
    
        <a href="/page/12/" class="label-pagination">12</a>
    
        <a href="/page/13/" class="label-pagination">13</a>
    
        <a href="/page/14/" class="label-pagination">14</a>
    
        <a href="/page/15/" class="label-pagination">15</a>
    
        <a href="/page/16/" class="label-pagination">16</a>
    
        <a href="/page/17/" class="label-pagination">17</a>
    
        <a href="/page/18/" class="label-pagination">18</a>
    
        <a href="/page/19/" class="label-pagination">19</a>
    
        <a href="/page/20/" class="label-pagination">20</a>
    
        <a href="/page/21/" class="label-pagination">21</a>
    
        <a href="/page/22/" class="label-pagination">22</a>
    
        <a href="/page/23/" class="label-pagination">23</a>
    
        <a href="/page/24/" class="label-pagination">24</a>
    
        <a href="/page/25/" class="label-pagination">25</a>
    
        <a href="/page/26/" class="label-pagination">26</a>
    
        <a href="/page/27/" class="label-pagination">27</a>
    
        <a href="/page/28/" class="label-pagination">28</a>
    
        <a href="/page/29/" class="label-pagination">29</a>
    
        <a href="/page/30/" class="label-pagination">30</a>
    
        <a href="/page/31/" class="label-pagination">31</a>
    
        <a href="/page/32/" class="label-pagination">32</a>
    
        <a href="/page/33/" class="label-pagination">33</a>
    

    
    
        <a href="/page/2/" aria-label="Next" class="label-pagination"><i class="fa fa-angle-right fa-lg"></i></a>
    

    
    
        <a href="/page/33/" aria-label="Last"><i class="fa fa-angle-double-right fa-lg"></i></a>
    

</div>

  
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    

    <p>
      
    </p>
  </section>



  
  <ul class="sidebar-nav">
    <li class="sidebar-nav-item">
      <a target="_blank" href="https://github.com/shogo82148/" title="https://github.com/shogo82148/"><i class="fa fa-github fa-3x"></i></a>
      
      
      <a target="_blank" href="https://twitter.com/shogo82148/" title="https://twitter.com/shogo82148/"><i class="fa fa-twitter fa-3x"></i></a>
      
         
      
      
      
      
      
      
      
      

    
    
    </li>
  </ul>

  

  

  
  
  
    
      <section class="even">
        <h1>Recent Posts</h1>
        <ul id="recent_posts">
          
          
            
              <li class="post">
                <a href="/blog/2025/12/16/aws-lambda-supports-managed-instances/">AWS::Lambdaがマネージドインスタンスに対応しました</a>
              </li>
            
          
            
          
            
              <li class="post">
                <a href="/blog/2025/12/13/perl-on-java/">PerlOnJavaで遊んでみた</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/11/any-and-all-keywords-in-perl/">Perl 5.42.0 の any と all キーワードを試してみた</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/10/synctest-not-supported-with-asynctimerchan/">Goのsynctestを使おうとしたらsynctest.Run not supported with asynctimerchanと怒られたときの対処法</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/10/signatures-named-parameters-in-perl/">Perl 5.43.5 の Signatures Named Parameters を先取り</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/03/anybatross-2025fukuoka/">コードゴルフコンテスト Anybatross YAPC::Fukuoka 2025 に参加した</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/11/06/my-number-and-prime/">マイナンバーを全列挙して含まれる素数の数を数えた</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/10/26/split-actions-setup-mysql/">shogo82148/actions-setup-mysqlのMySQLビルドスクリプト群を別レポジトリーに移行した</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/10/24/deep-dig-uber-go-dig/">uber-go/dig を深堀りしてみる</a>
              </li>
            
          
        </ul>
      </section>
    
  
</aside>
    
  </div>
</div>
<footer role="contentinfo">
  <p>Copyright &copy; 2025 ICHINOSE Shogo - <a
      href="https://shogo82148.github.io/license/">License</a> -
    <span class="credit">Powered by <a target="_blank" href="https://gohugo.io">Hugo</a> and <a target="_blank"
        href="https://github.com/parsiya/hugo-octopress/">Hugo-Octopress</a> theme.
  </p>
</footer>









</body>

</html>
   



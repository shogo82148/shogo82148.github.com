<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic:wght@400;700&family=Noto+Sans+Mono&display=swap" rel="stylesheet"> 

  
  <title>コードゴルフコンテスト Anybatross YAPC::Fukuoka 2025 に参加した</title>

  
  
  <link rel="stylesheet" href="/css/hugo-octopress.css">

  
  
    <link rel="stylesheet" href="https://shogo82148.github.io/css/syntax.css">
  

  
  <link href="https://shogo82148.github.io/favicon.png" rel="icon">

  
  

  <meta name="description" content="" />
  <meta name="keywords" content="">
  <meta name="author" content="ICHINOSE Shogo">

  
  <meta name="generator" content="Hugo 0.120.4">


<script async src="https://www.googletagmanager.com/gtag/js?id=G-40R0PCLKVF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-40R0PCLKVF');
</script>


<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

  
  
</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="https://shogo82148.github.io/">Shogo&#39;s Blog</a></h1>
  <h2></h2>
</hgroup>
</header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
</ul>

<ul class="subscription">
  
</ul>


  <form action="https://www.google.com/search" method="get" target="_blank">
    <fieldset role="search">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <input type="hidden" name="q" value="site:https://shogo82148.github.io/" />
    </fieldset>
  </form>

</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
  <p class="meta">Dec 3, 2025
     - 4 minute read 
    

    
    
      - <a class="label" href="https://shogo82148.github.io/categories/perl/">perl </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://shogo82148.github.io/blog/2025/12/03/anybatross-2025fukuoka/">コードゴルフコンテスト Anybatross YAPC::Fukuoka 2025 に参加した</a>
  </h1>
</header>


        <div class="entry-content">
          
          
          
          
          <p>この記事は、<a href="https://qiita.com/advent-calendar/2025/perl">Perl Advent Calendar 2025</a> 4日目の記事です。 3日目は<a href="https://profile.hatena.ne.jp/hkoba501/">id:hkoba501</a>で「<a href="https://hkoba.hatenablog.com/entry/2025/12/02/000000">Claude Code は OO Modulino （オゥオゥ・モジュリーノ）も理解してくれる、ぽい！</a>」でした。</p>
<hr>
<p>YAPC::Fukuoka 2025 の余興で<a href="https://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%BC%E3%83%89%E3%82%B4%E3%83%AB%E3%83%95">コードゴルフ</a>コンテストが開催されました。</p>
<ul>
<li><a href="https://techblog.kayac.com/anybatross-yapc2025fukuoka">コードゴルフコンテスト Anybatross YAPC::Fukuoka 2025 開催のお知らせ</a></li>
<li><a href="https://perlbatross.kayac.com/contest/2025fukuoka"><del>Perl</del>Anybatross YAPC::Fukuoka 2025</a></li>
</ul>
<p>コードゴルフとは、与えられた仕様に対してできる限り短いソースコードで解答するというゲームです。
今回はPerl、Ruby、Python、JavaScript、PHPなどで参加可能ですが、<del>Perl Advent Calendarのネタのために、</del>　個人的に一番馴染み深いPerlを使って参加しました。
結果、すべての問題をPerlでチャレンジした人の中では2位になることができました。</p>
<h2 id="hole-1">Hole 1</h2>
<blockquote>
<p>アルファベットのAやBにあるような、文字の中にある閉じた空間のことをカウンターといいます。</p>
<p>0〜9までの10種と、アルファベット大文字のA〜Zの26種、合計36種の文字やその他の記号を利用した文字列が渡されるので、カウンターの数を数えてください。アルファベット小文字は来ません。その他の記号のカウンターは数えなくてよいです。</p>
<p>1行ずつ数えて、その行までの累積個数と、その行での出現個数を出力してください。</p>
<ul>
<li><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/sample">https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/sample</a></li>
</ul>
</blockquote>
<p>サンプルのコードが提供されているので、まずはここから始めていきましょう。</p>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/01K9P8RR8BP9WVVXVFMAS6D554">Score: +1065</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="k">use</span> <span class="nn">v5</span><span class="mf">.40</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nn">utf8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">our</span> <span class="nv">$COUNTER_MAP</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;0&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;1&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;2&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;3&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;4&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;5&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;6&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;7&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;8&#39;</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;9&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;A&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;B&#39;</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;C&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;D&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;E&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;F&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;G&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;H&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;I&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;J&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;K&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;L&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;M&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;N&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;O&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;P&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;Q&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;R&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;S&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;T&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;U&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;V&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;W&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;X&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;Y&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#39;Z&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$input</span> <span class="o">=</span> <span class="k">do</span> <span class="p">{</span> <span class="nb">local</span> <span class="vg">$/</span><span class="p">;</span> <span class="sr">&lt;STDIN&gt;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@lines</span> <span class="o">=</span> <span class="nb">split</span> <span class="sr">/\n/</span><span class="p">,</span> <span class="nv">$input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@results</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$accumulated_count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 行ごとに処理する</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="k">my</span> <span class="nv">$line_num</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="nb">scalar</span><span class="p">(</span><span class="nv">@lines</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 1行を1文字ずつ分割</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">@chars</span> <span class="o">=</span> <span class="nb">split</span> <span class="sr">//</span><span class="p">,</span> <span class="nv">$lines</span><span class="p">[</span><span class="nv">$line_num</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 1文字ずつカウンターの数を合計</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">$total_count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="k">my</span> <span class="nv">$char</span> <span class="p">(</span><span class="nv">@chars</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$total_count</span> <span class="o">+=</span> <span class="nv">$COUNTER_MAP</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$char</span><span class="p">}</span> <span class="sr">//</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$accumulated_count</span> <span class="o">+=</span> <span class="nv">$total_count</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">push</span> <span class="nv">@results</span><span class="p">,</span> <span class="nv">$accumulated_count</span> <span class="o">.</span> <span class="s">&#39;,&#39;</span> <span class="o">.</span> <span class="nv">$total_count</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="k">my</span> <span class="nv">$result</span> <span class="p">(</span><span class="nv">@results</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">print</span> <span class="nv">$result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 1行ごとに改行</span>
</span></span><span class="line"><span class="cl">    <span class="k">print</span> <span class="s">&#34;\n&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ここから全体の構成をなるべく変えないように少しずつ削っていきます。</p>
<ul>
<li>変数名に一文字変数名を採用する。</li>
<li>一度しか代入していない変数は削る。</li>
<li><code>$COUNTER_MAP</code> の0の要素は不要なので削る。</li>
<li>特殊変数 <code>$_</code> を使う。</li>
</ul>
<p>すると以下のようになります。
（読みやすいよう改行だけ補いました）</p>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/01K9PF27B9NSWBCAQRWM8VKJYC">Score: +7</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="nv">%M</span><span class="o">=</span><span class="p">(</span><span class="nb">split</span><span class="sr">//</span><span class="p">,</span><span class="s">&#39;0141618291A1B2D1O1P1Q1R1&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$b</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$b</span><span class="o">+=</span><span class="nv">$M</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span><span class="sr">//</span><span class="mi">0</span> <span class="k">for</span><span class="p">(</span><span class="nb">split</span><span class="sr">//</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$a</span><span class="o">+=</span><span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">print</span><span class="s">&#34;$a,$b\n&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ul>
<li>よくよく見てみると<code>$COUNTER_MAP</code>も一度しか使われていません。変数に代入するのはムダなので削ります。</li>
<li><code>undef</code> は数値コンテキストでは0と評価されるので <code>$b+=$M{$_}//0</code> の <code>//0</code> は不要です。</li>
</ul>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/01K9PHV59PP1ZTB0FDPR4H0PXX">Score: -2</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$b</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$b</span><span class="o">+=</span><span class="p">{</span><span class="nb">split</span><span class="sr">//</span><span class="p">,</span><span class="s">&#39;0141618291A1B2D1O1P1Q1R1&#39;</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span><span class="k">for</span> <span class="nb">split</span><span class="sr">//</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$a</span><span class="o">+=</span><span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">print</span><span class="s">&#34;$a,$b\n&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ここまでとりあえずパーは達成です。
もう数バイトであれば削れそうですが、今のままのアルゴリズムでは限界が見えてきました。</p>
<p>そこでちょっと見かたを変えてみます。
<code>split</code>して一文字ごとにカウントしてきましたが、最終的に必要なのはカウンターの合計です。
合計を算出するだけなら各文字の出現回数が分かれば十分です。
<a href="https://shogo82148.github.io/blog/2015/04/09/count-substrings-in-perl/">Perlで文字列の出現回数を調べる</a> で登場した<a href="https://metacpan.org/dist/perlsecret/view/lib/perlsecret.pod#Goatse">画像検索してはいけない演算子</a>を使えば一発ですね。</p>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/01K9Q0501KN0QQJZ3V91N9NND7">Score: -43</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">+=</span><span class="nv">$b</span><span class="o">=</span><span class="p">()</span><span class="o">=</span><span class="p">(</span><span class="sr">/[04689ABDO-R]/g</span><span class="p">,</span><span class="sr">/[8B]/g</span><span class="p">),</span><span class="k">print</span><span class="s">&#34;$a,$b\n&#34;</span><span class="k">for</span><span class="o">&lt;&gt;</span><span class="p">;</span>
</span></span></code></pre></div><p>だいぶ短くなりましたが、リストコンテキストとスカラーコンテキストを行き来する分、
若干ムダが多いように見えます。</p>
<p>「スカラーコンテキストで評価したら出現回数を返してくれる便利な演算子ないかな」とperldocを彷徨っていたところ <code>s///</code> 演算子に行き着きました。
<code>s///</code> は置換を行う際に使う演算子ですが、評価結果として置換した回数を返します。</p>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/01K9W2XYF6SFA9SPJZY1SMTWWA">Score: -45</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="k">print</span><span class="nv">$a</span><span class="o">+=</span><span class="nv">$b</span><span class="o">=</span><span class="sr">s/[8B]/0/g</span><span class="o">+</span><span class="sr">s/[04689ABDO-R]//g</span><span class="p">,</span><span class="s">&#34;,$b\n&#34;</span><span class="k">for</span><span class="o">&lt;&gt;</span>
</span></span></code></pre></div><p>さらに perldoc を彷徨って、<code>y///</code> 演算子を使うと同等の処理をもっと短く書けることに気が付きました。<code>y///</code> 演算子も置換を行ったあと、評価結果として置換した回数を返します。</p>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/01K9XV7DDMEXM2MBXZS1SARJKS">Score: -54</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="k">print</span><span class="nv">$a</span><span class="o">+=</span><span class="nv">$b</span><span class="o">=</span><span class="n">y</span><span class="sr">/8B/</span><span class="mi">0</span><span class="sr">/+y/</span><span class="mo">046</span><span class="mi">9</span><span class="n">ADO</span><span class="o">-</span><span class="n">R</span><span class="sr">//</span><span class="p">,</span><span class="s">&#34;,$b\n&#34;</span><span class="k">for</span><span class="o">&lt;&gt;</span>
</span></span></code></pre></div><p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/01K9WZ30XVCANH9CZPD7A8VESR">yamamoto さんの解答</a> を見て気がついたのですが、 <code>&quot;&quot;</code> の中に直接改行って書けるんですね。<code>\n</code> を改行に置き換えて -1 バイトです。</p>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/1/01K9XVJQPG4JBAZAKRSNAFNN8Y">Score: -55</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="k">print</span><span class="nv">$a</span><span class="o">+=</span><span class="nv">$b</span><span class="o">=</span><span class="n">y</span><span class="sr">/8B/</span><span class="mi">0</span><span class="sr">/+y/</span><span class="mo">046</span><span class="mi">9</span><span class="n">ADO</span><span class="o">-</span><span class="n">R</span><span class="sr">//</span><span class="p">,</span><span class="s">&#34;,$b
</span></span></span><span class="line"><span class="cl"><span class="s">&#34;</span><span class="k">for</span><span class="o">&lt;&gt;</span>
</span></span></code></pre></div><h2 id="hole-2">Hole 2</h2>
<blockquote>
<p>アルファベット小文字と半角スペースを用いて分かち書きされたテキストが標準入力で与えられます。このテキストを以下のルールに従って圧縮してください。</p>
<ul>
<li><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/2/sample">https://perlbatross.kayac.com/contest/2025fukuoka/challenge/2/sample</a></li>
</ul>
</blockquote>
<p>Hole 2もまずはサンプルコードを通してランキングに載るところからスタートです。</p>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/2/01K9P8TVGJ3M0BQBAM0X0EQXCR">Score: +2798</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="k">use</span> <span class="nn">v5</span><span class="mf">.40</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nn">utf8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nn">Encode</span> <span class="sx">qw/encode_utf8 decode_utf8/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 標準入力のすべての行を最後まで取り込み</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$input</span> <span class="o">=</span> <span class="k">do</span> <span class="p">{</span> <span class="nb">local</span> <span class="vg">$/</span><span class="p">;</span> <span class="sr">&lt;STDIN&gt;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 辞書出力用変数</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">%dict</span> <span class="o">=</span> <span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 末尾改行を削除</span>
</span></span><span class="line"><span class="cl"><span class="nb">chomp</span> <span class="nv">$input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># utf8の内部形式に変換 文字単位での分割をutf8の基準で行うため</span>
</span></span><span class="line"><span class="cl"><span class="nv">$input</span> <span class="o">=</span> <span class="n">decode_utf8</span><span class="p">(</span><span class="nv">$input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="n">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 空白区切りの単語単位で分割</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">@words</span> <span class="o">=</span> <span class="nb">split</span> <span class="sr">/ /</span><span class="p">,</span> <span class="nv">$input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">@bigrams</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 単語ごとに処理</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="k">my</span> <span class="nv">$word</span> <span class="p">(</span><span class="nv">@words</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># bigramを作成</span>
</span></span><span class="line"><span class="cl">        <span class="k">my</span> <span class="nv">@chars</span> <span class="o">=</span> <span class="nb">split</span> <span class="sr">//</span><span class="p">,</span> <span class="nv">$word</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="k">my</span> <span class="nv">$i</span> <span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="nb">scalar</span><span class="p">(</span><span class="nv">@chars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nb">push</span> <span class="nv">@bigrams</span><span class="p">,</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># bigramの出現頻度を計算</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 出現する順番も保持する</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">%bigram_freq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">%bigram_order</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="k">my</span> <span class="nv">$bigram</span> <span class="p">(</span><span class="nv">@bigrams</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$bigram_freq</span><span class="p">{</span><span class="nv">$bigram</span><span class="p">}</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$bigram_freq</span><span class="p">{</span><span class="nv">$bigram</span><span class="p">}</span> <span class="sr">//</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">exists</span> <span class="nv">$bigram_order</span><span class="p">{</span><span class="nv">$bigram</span><span class="p">})</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">my</span> <span class="nv">$current_order_size</span> <span class="o">=</span> <span class="nb">scalar</span><span class="p">(</span><span class="nb">keys</span> <span class="nv">%bigram_order</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$bigram_order</span><span class="p">{</span><span class="nv">$bigram</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$current_order_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 最も大きい出現頻度を持つbigramを探す</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 頻度が同じ場合は出現順で比較</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">$max_bigram</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="k">my</span> <span class="p">(</span><span class="nv">$bigram</span><span class="p">,</span> <span class="nv">$freq</span><span class="p">)</span> <span class="p">(</span><span class="nv">%bigram_freq</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">defined</span> <span class="nv">$max_bigram</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$max_bigram</span> <span class="o">=</span> <span class="nv">$bigram</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$freq</span> <span class="o">&gt;</span> <span class="nv">$bigram_freq</span><span class="p">{</span><span class="nv">$max_bigram</span><span class="p">})</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$max_bigram</span> <span class="o">=</span> <span class="nv">$bigram</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$freq</span> <span class="o">&lt;</span> <span class="nv">$bigram_freq</span><span class="p">{</span><span class="nv">$max_bigram</span><span class="p">})</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$bigram_order</span><span class="p">{</span><span class="nv">$bigram</span><span class="p">}</span> <span class="o">&lt;</span> <span class="nv">$bigram_order</span><span class="p">{</span><span class="nv">$max_bigram</span><span class="p">})</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$max_bigram</span> <span class="o">=</span> <span class="nv">$bigram</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$bigram_freq</span><span class="p">{</span><span class="nv">$max_bigram</span><span class="p">}</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">last</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 現在の辞書のサイズから置き換え用文字を決定</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">$dict_size</span> <span class="o">=</span> <span class="nb">scalar</span><span class="p">(</span><span class="nb">keys</span> <span class="nv">%dict</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">$replacement</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x41</span> <span class="o">+</span> <span class="nv">$dict_size</span><span class="p">);</span> <span class="c1"># &#39;A&#39;のコードポイントは0x41</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$dict</span><span class="p">{</span><span class="nv">$replacement</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$max_bigram</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">$next_input</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 単語ごとに置き換える</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="k">my</span> <span class="nv">$i</span> <span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="nb">scalar</span><span class="p">(</span><span class="nv">@words</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">my</span> <span class="nv">$word</span> <span class="o">=</span> <span class="nv">$words</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">my</span> <span class="nv">@chars</span> <span class="o">=</span> <span class="nb">split</span> <span class="sr">//</span><span class="p">,</span> <span class="nv">$word</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">my</span> <span class="nv">$skipped</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="k">my</span> <span class="nv">$i</span> <span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="nb">scalar</span><span class="p">(</span><span class="nv">@chars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$skipped</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$skipped</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">==</span> <span class="nb">scalar</span><span class="p">(</span><span class="nv">@chars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$next_input</span> <span class="o">=</span> <span class="nv">$next_input</span> <span class="o">.</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="k">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">my</span> <span class="nv">$bigram</span> <span class="o">=</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$bigram</span> <span class="ow">eq</span> <span class="nv">$max_bigram</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$next_input</span> <span class="o">=</span> <span class="nv">$next_input</span> <span class="o">.</span> <span class="nv">$replacement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$skipped</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$next_input</span> <span class="o">=</span> <span class="nv">$next_input</span> <span class="o">.</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nb">scalar</span><span class="p">(</span><span class="nv">@words</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$next_input</span> <span class="o">=</span> <span class="nv">$next_input</span> <span class="o">.</span> <span class="s">&#34; &#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$input</span> <span class="o">=</span> <span class="nv">$next_input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@keys</span> <span class="o">=</span> <span class="nb">sort</span> <span class="nb">keys</span> <span class="nv">%dict</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@entries</span> <span class="o">=</span> <span class="nb">map</span> <span class="p">{</span> <span class="s">&#34;$_:$dict{$_}&#34;</span> <span class="p">}</span> <span class="nv">@keys</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$dictionary_line</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="nv">@entries</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">say</span> <span class="n">encode_utf8</span><span class="p">(</span><span class="nv">$dictionary_line</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">say</span> <span class="n">encode_utf8</span><span class="p">(</span><span class="nv">$input</span><span class="p">);</span>
</span></span></code></pre></div><p>Hole 1 と同様にコードを整理していくと次のようになりました。</p>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/2/01K9PX2XWTPN8ZSF628ZYTHTHE">Score: +297</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="k">use</span> <span class="nn">Encode</span> <span class="sx">qw/encode_utf8 decode_utf8/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">%d</span><span class="o">=</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nb">chomp</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="k">do</span><span class="p">{</span><span class="nb">local</span><span class="vg">$/</span><span class="p">;</span><span class="n">decode_utf8</span><span class="sr">&lt;STDIN&gt;</span><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="s">&#39;A&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(;;)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span><span class="p">(</span><span class="nv">%f</span><span class="p">,</span><span class="nv">%o</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="nb">split</span><span class="sr">/ /</span><span class="p">,</span> <span class="nv">$i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">@c</span> <span class="o">=</span> <span class="nb">split</span> <span class="sr">//</span><span class="p">,</span> <span class="nv">$_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="nv">@c</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$b</span><span class="o">=</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$_</span><span class="p">]</span><span class="o">.</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$_</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$f</span><span class="p">{</span><span class="nv">$b</span><span class="p">}</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$o</span><span class="p">{</span><span class="nv">$b</span><span class="p">}</span><span class="sr">//</span><span class="o">=</span><span class="nb">keys</span><span class="nv">%o</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">my</span> <span class="nv">$m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="k">my</span> <span class="p">(</span><span class="nv">$b</span><span class="p">,</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">(</span><span class="nv">%f</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$m</span><span class="o">=</span><span class="nv">$b</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$m</span><span class="o">||</span><span class="nv">$f</span><span class="o">&gt;</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$m</span><span class="p">}</span><span class="o">||</span><span class="p">(</span><span class="nv">$f</span><span class="o">==</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$m</span><span class="p">}</span><span class="o">&amp;&amp;</span><span class="nv">$o</span><span class="p">{</span><span class="nv">$b</span><span class="p">}</span><span class="o">&lt;</span><span class="nv">$o</span><span class="p">{</span><span class="nv">$m</span><span class="p">}))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">last</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$m</span><span class="p">}</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$d</span><span class="p">{</span><span class="nv">$a</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$i</span> <span class="o">=~</span> <span class="sr">s/$m/$a/g</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$a</span><span class="o">++</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">print</span> <span class="n">encode_utf8</span><span class="p">(</span><span class="nb">join</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span><span class="nb">map</span><span class="p">{</span><span class="s">&#34;$_:$d{$_}&#34;</span><span class="p">}</span><span class="nb">sort</span> <span class="nb">keys</span><span class="nv">%d</span><span class="p">)</span><span class="o">.</span><span class="s">&#34;\n$i\n&#34;</span><span class="p">);</span>
</span></span></code></pre></div><p>わざわざサンプルに <code>encode_utf8</code> <code>decode_utf8</code> とつけているので、「きっとこれには意味があるのだろう」と思ってそのままにしておいたのですが、思い切って削除してみると見事AC！</p>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/2/01K9VWZEPRGMGY965VGS3342W9">Score: +37</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="nb">chomp</span><span class="p">(</span><span class="nv">$i</span><span class="o">=&lt;&gt;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="s">&#39;A&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(;;){</span>
</span></span><span class="line"><span class="cl">  <span class="nv">%f</span><span class="o">=</span><span class="nv">%o</span><span class="o">=</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span><span class="p">(</span><span class="nb">split</span><span class="sr">/ /</span><span class="p">,</span><span class="nv">$i</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">@c</span><span class="o">=</span><span class="sr">/./g</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="nv">@c</span><span class="o">-</span><span class="mi">2</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$b</span><span class="o">=</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$_</span><span class="p">]</span><span class="o">.</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$_</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$f</span><span class="p">{</span><span class="nv">$b</span><span class="p">}</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$o</span><span class="p">{</span><span class="nv">$b</span><span class="p">}</span><span class="sr">//</span><span class="o">=</span><span class="nb">keys</span><span class="nv">%o</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="k">my</span><span class="p">(</span><span class="nv">$b</span><span class="p">,</span><span class="nv">$f</span><span class="p">)(</span><span class="nv">%f</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$m</span><span class="o">=</span><span class="nv">$b</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$m</span><span class="o">||</span><span class="nv">$f</span><span class="o">&gt;</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$m</span><span class="p">}</span><span class="o">||</span><span class="nv">$f</span><span class="o">==</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$m</span><span class="p">}</span><span class="o">&amp;&amp;</span><span class="nv">$o</span><span class="p">{</span><span class="nv">$b</span><span class="p">}</span><span class="o">&lt;</span><span class="nv">$o</span><span class="p">{</span><span class="nv">$m</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">last</span> <span class="k">if</span><span class="p">(</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$m</span><span class="p">}</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nv">$i</span><span class="o">=~</span><span class="sr">s/$m/$a/g</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$d</span><span class="p">{</span><span class="nv">$a</span><span class="o">++</span><span class="p">}</span><span class="o">=</span><span class="nv">$m</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">print</span> <span class="nb">join</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span><span class="nb">map</span><span class="p">{</span><span class="s">&#34;$_:$d{$_}&#34;</span><span class="p">}</span><span class="nb">sort</span> <span class="nb">keys</span><span class="nv">%d</span><span class="p">)</span><span class="o">.</span><span class="s">&#34;\n$i\n&#34;</span>
</span></span></code></pre></div><p>改めて問題文をよく見直してみると「アルファベット小文字と半角スペース」と明記してありましたね。「問題文をよく見ろ」という話です。</p>
<hr>
<p>さてさてここからどうするか・・・ちょっと行き詰まってしまったので、ChatGPT に以下のように聞いてみました。</p>
<blockquote>
<p>あなたはコードゴルフのプロです。以下のPerlのコードを出力結果を変えないよう、短く書いてください</p>
<p>具体的にどのように処理を書き換えたのか説明してください</p>
</blockquote>
<p>返ってきたコードは残念ながら動かないものでしたが、<code>while(/(?=(..))/g)</code> という見慣れない記法を使っていて、ナンダコレハとなりました。
perldocを参照すると「ゼロ幅の肯定先読み表明」と呼ぶらしいです。
これを参考に書き換えたのがこちら。</p>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/2/01K9W1FNX1JSRB49ZZGJZ3KPGS">Score: -36</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="nb">chomp</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="k">do</span><span class="p">{</span><span class="nb">local</span><span class="vg">$/</span><span class="p">;</span><span class="o">&lt;&gt;</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="s">&#39;A&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(;;){</span>
</span></span><span class="line"><span class="cl">  <span class="nv">%f</span><span class="o">=</span><span class="nv">@e</span><span class="o">=</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span><span class="p">(</span><span class="nb">split</span><span class="sr">/ /</span><span class="p">,</span><span class="nv">$i</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="sr">/(?=(..))/g</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$f</span><span class="p">{</span><span class="nv">$1</span><span class="p">}</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nb">push</span><span class="nv">@e</span><span class="p">,</span><span class="nv">$1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span><span class="p">(</span><span class="nv">@e</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$m</span><span class="o">=</span><span class="nv">$_</span> <span class="k">if</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span><span class="o">&gt;</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$m</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">last</span> <span class="k">if</span><span class="p">(</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$m</span><span class="p">}</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$i</span><span class="o">=~</span><span class="sr">s/$m/$a/g</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">push</span><span class="nv">@d</span><span class="p">,</span><span class="s">&#34;$a:$m&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$a</span><span class="o">++</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">print</span> <span class="nb">join</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span><span class="nv">@d</span><span class="p">)</span><span class="o">.</span><span class="s">&#34;\n$i\n&#34;</span>
</span></span></code></pre></div><p>ここから地道に数バイトずつ削っていきます。</p>
<ul>
<li><code>/(?=(..))/g</code> を <code>/(?=(\S\S))/g</code> に置き換えて、<code>split / /</code> の分を削る。</li>
<li>sortを使って最頻値を取得。Perlのソートは（少なくともPerl 5.42の時点では）安定ソードなので、出現場所順にソートしてある出現頻度順にソートすると、同じ出現頻度では出現場所が早い要素が優先されます。</li>
<li><code>for(;;)</code> の中に書けるものはそちらに移す。<code>;</code> の分だけお得。</li>
<li>ソースコード中に出てくる bare word は、対応する関数が存在しなければ文字列として解釈されるので、<code>''</code> を外せる。</li>
<li><code>join(',',@d)</code> するより <code>$&quot;=',';&quot;@d&quot;</code> のほうが短い。</li>
</ul>
<blockquote>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka/challenge/2/01KA6TTCJMJZX7FGNV75HXMJG2">Score: -114</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="nv">$_</span><span class="o">=&lt;&gt;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$a</span><span class="o">=</span><span class="n">A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">%f</span><span class="o">=</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">map</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span><span class="o">++</span><span class="p">,</span><span class="nv">@e</span><span class="o">=</span><span class="sr">/(?=(\S\S))/g</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$f</span><span class="p">{</span><span class="nv">$m</span><span class="o">=</span><span class="p">(</span><span class="nb">sort</span><span class="p">{</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$b</span><span class="p">}</span><span class="o">-</span><span class="nv">$f</span><span class="p">{</span><span class="nv">$a</span><span class="p">}}</span><span class="nv">@e</span><span class="p">)[</span><span class="mi">0</span><span class="p">]}</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">push</span><span class="nv">@d</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$a</span><span class="o">++.</span><span class="s">&#34;:$m&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="sr">s/$m/$a/g</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="vg">$&#34;</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">;</span><span class="k">print</span><span class="s">&#34;@d
</span></span></span><span class="line"><span class="cl"><span class="s">$_&#34;</span>
</span></span></code></pre></div><h2 id="まとめ">まとめ</h2>
<p><a href="https://perlbatross.kayac.com/contest/2025fukuoka"><del>Perl</del>Anybatross YAPC::Fukuoka 2025</a>に参加し、全問Perlで解いた人としては2位になりました。</p>
<p>文字列置換（<code>s///</code>, <code>y///</code>）の戻り値とかあまり気にしたことがなかったので勉強になりました。
また、正規表現の先読みにこんな使い方（Hole2）があるとははじめて知りました。このことはChatGPTを使わなければ気が付かなかったと思うので、個人的にはAI大活躍でした。</p>
<hr>
<p>明日5日は<a href="https://qiita.com/ytnobody">わいとん（@ytnobody）</a>で、「<a href="https://ytnobody.github.io/wyton/2025/12/04/2025-12-04-001/">Perlからでもtursoを使いたい！</a>」です。お楽しみに！</p>
<blockquote>
<p>🐰 ゴルフボール、コードで短く、✨<br>
ホール1、ホール2、スコアを詰めて、<br>
Perlの技、磨きに磨いて、<br>
短さを極める、おもしろき修行かな。</p>
<p>by <a href="https://www.coderabbit.ai/">CodeRabbit</a></p>
</blockquote>

        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">ICHINOSE Shogo</span></span>
    
    <time>Dec 3, 2025</time>
    
    </span>
  </p>

  

  <p class="meta">
    
        <a class="basic-alignment left" href="https://shogo82148.github.io/blog/2025/11/06/my-number-and-prime/" title="マイナンバーを全列挙して含まれる素数の数を数えた">マイナンバーを全列挙して含まれる素数の数を数えた</a>
    

    
      <a class="basic-alignment right" href="https://shogo82148.github.io/blog/2025/12/10/signatures-named-parameters-in-perl/" title="Perl 5.43.5 の Signatures Named Parameters を先取り">Perl 5.43.5 の Signatures Named Parameters を先取り</a>
    
  </p>
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    

    <p>
      
    </p>
  </section>



  
  <ul class="sidebar-nav">
    <li class="sidebar-nav-item">
      <a target="_blank" href="https://github.com/shogo82148/" title="https://github.com/shogo82148/"><i class="fa fa-github fa-3x"></i></a>
      
      
      <a target="_blank" href="https://twitter.com/shogo82148/" title="https://twitter.com/shogo82148/"><i class="fa fa-twitter fa-3x"></i></a>
      
         
      
      
      
      
      
      
      
      

    
    
    </li>
  </ul>

  

  

  
  
  
    
      <section class="even">
        <h1>Recent Posts</h1>
        <ul id="recent_posts">
          
          
            
              <li class="post">
                <a href="/blog/2025/12/24/perl-5.42-new-warnings/">Perl 5.42 から新しく入った警告を試してみる</a>
              </li>
            
          
            
          
            
              <li class="post">
                <a href="/blog/2025/12/24/perl-class-lexical-method/">Perlクラスのレキシカルメソッドを試してみる</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/24/perl-class-writer-attribute/">Perlのフィールド変数の:writer属性を試してみる</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/16/aws-lambda-supports-managed-instances/">AWS::Lambdaがマネージドインスタンスに対応しました</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/13/perl-on-java/">PerlOnJavaで遊んでみた</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/11/any-and-all-keywords-in-perl/">Perl 5.42.0 の any と all キーワードを試してみた</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/10/synctest-not-supported-with-asynctimerchan/">Goのsynctestを使おうとしたらsynctest.Run not supported with asynctimerchanと怒られたときの対処法</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/10/signatures-named-parameters-in-perl/">Perl 5.43.5 の Signatures Named Parameters を先取り</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2025/12/03/anybatross-2025fukuoka/">コードゴルフコンテスト Anybatross YAPC::Fukuoka 2025 に参加した</a>
              </li>
            
          
        </ul>
      </section>
    
  
</aside>

  </div>
</div>

<footer role="contentinfo">
  <p>Copyright &copy; 2025 ICHINOSE Shogo - <a
      href="https://shogo82148.github.io/license/">License</a> -
    <span class="credit">Powered by <a target="_blank" href="https://gohugo.io">Hugo</a> and <a target="_blank"
        href="https://github.com/parsiya/hugo-octopress/">Hugo-Octopress</a> theme.
  </p>
</footer>









</body>

</html>


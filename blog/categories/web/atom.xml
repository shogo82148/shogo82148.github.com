<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: web | Shogo's Blog]]></title>
  <link href="https://shogo82148.github.io/blog/categories/web/atom.xml" rel="self"/>
  <link href="https://shogo82148.github.io/"/>
  <updated>2017-01-22T23:00:48+09:00</updated>
  <id>https://shogo82148.github.io/</id>
  <author>
    <name><![CDATA[Shogo Ichinose]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[GitHub Pagesがhttpsをサポートしたので切り替えてみた]]></title>
    <link href="https://shogo82148.github.io/blog/2016/06/10/github-page-supports-https/"/>
    <updated>2016-06-10T00:53:51+09:00</updated>
    <id>https://shogo82148.github.io/blog/2016/06/10/github-page-supports-https</id>
    <content type="html"><![CDATA[<p>このブログを設置しているGithub PagesがHTTPSに正式対応したらしいので、HTTPSを強制するように設定してみました。</p>

<ul>
<li><a href="https://github.com/blog/2186-https-for-github-pages">HTTPS for GitHub Pages</a></li>
</ul>


<!-- More -->


<h2>やったこと</h2>

<p>ページ内にHTTP経由で取得したリソースが含まれていると、
警告が出たり取得自体がブロックされたりしてしまうので、
全てHTTPS経由で取得するように書きなおす必要があります。
画像・CSS・Javascript等のURLを、以下のようにnetwork-path referenceへの置き換えましょう。
HTTPでページを開いた場合はHTTPで、HTTPSでページを開いた場合はHTTPSで、リソースを取得してくれます。</p>

<pre><code class="plain">&lt;a href="http://google.co.jp"&gt;
&lt;a href="//google.co.jp"&gt;
</code></pre>

<p>このサイトはHTTPのレンダリングに<a href="https://github.com/imathis/octopress">Octopress</a>を使っています。
最新版のOctopressではnetwork-path referenceを使ってくれるので特に対応は不要です。
このサイトの場合は古すぎてHTTP参照だったので、
「<a href="http://blog.glidenote.com/blog/2014/02/14/octopress-update/">Octopressをアップデートした</a>」を参考にしてアップデートしました。
はてなブックマーク連携など、自分でカスタマイズした部分に関しては手作業で対応したました。</p>

<h3>HTTPS強制の設定</h3>

<p><a href="https://help.github.com/articles/securing-your-github-pages-site-with-https/">Securing your GitHub Pages site with HTTPS</a> どおりに設定を有効化すればOKです。
ユーザ毎ではなくプロジェクト毎の設定のようなので、
プロジェクト用のページを作っている場合は個別に設定が必要です。</p>

<h2>はてなブックマークについて</h2>

<p>HTTPとHTTPSは別URLとして扱われるようなので、過去の記事に対するはてブ数はリセットされてしまいます。
解決方法は無いかと調べてみたものの、現象無理っぽいです。</p>

<p><a href="https://twitter.com/masutaka/status/739747936318283776">https://twitter.com/masutaka/status/739747936318283776</a>">https://twitter.com/masutaka/status/739747936318283776">https://twitter.com/masutaka/status/739747936318283776</a></a></p>

<p>はてなさんの方で対応してくれないかな・・・</p>

<h2>2016/06/30追記: DISQUSのマイグレーション</h2>

<p>記事にコメントをつけるのに使っている<a href="https://disqus.com/">DISQUS</a>をマイグレーションするのを忘れてて、
過去のコメントが見れなくなっていたので追記。</p>

<p><a href="https://disqus.com/">DISQUS</a>のホームから「Admin」「Edit Settings」で設定画面を開き、
Website URLの近くの「Changing domains? Learn how.」をクリックします。
すると「Migration Tools」が開くので、「Start URL mapper」「you can download a CSV here」をクリック。
5分くらいするとDISQUSがコメントを管理しているURL一覧がメールで届くので、
それを元に新旧URLの対応表を作ります。</p>

<p>今回はプロトコルの変更なので、以下のような雑なワンライナーで変換しました。
(改行コードがCRLFで地味に面倒だった)</p>

<pre><code>grep http:// links.csv | perl -e '$/="\r\n";while(&lt;&gt;){chomp;print "$_,@{[$_=~s/^http:/https:/r]}$/"}' &gt; new-links.csv
</code></pre>

<p>最後に設定画面からCSVをアップロードします。
以上で作業完了です。
最後に「24時間以内に反映するよ」的なメッセージが表示されましたが、僕の場合は5分くらいで反映が確認できました。</p>

<p>残るははてブ。はてなさん頼む〜〜〜。</p>
]]></content>
  </entry>
  
</feed>
